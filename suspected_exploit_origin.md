# 🔍 Suspected Exploit Origins: Rootkit Candidates

This document outlines the most likely rootkit families that share architectural and behavioral similarities with the persistent compromise under investigation. These candidates were selected based on cross-referenced indicators such as UEFI persistence, catalog trust spoofing, forged signatures, and stealth execution chains.

---

## 🟥 MoonBounce (APT41 / Winnti Group)

**Summary:**  
MoonBounce is a firmware-level rootkit discovered by Kaspersky in 2022, notable for infecting the SPI flash memory of UEFI firmware. It achieves pre-OS persistence and stages in-memory payloads without touching the disk. Its loader resides in the DXE driver stage, and it uses kernel-level hooks to inject shellcode into `winlogon.exe`. It features no dropped files, uses no standard persistence mechanisms, and evades most userland AV tools.

**Key Behaviors:**
- UEFI DXE injection
- In-memory payload staging
- Hooking system calls to redirect execution
- No filesystem traces

**Detailed Report:**  
[https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/](https://securelist.com/moonbounce-the-dark-side-of-uefi-firmware/105468/)

---

## 🟥 LoJax (APT28 / Fancy Bear)

**Summary:**  
LoJax was the first rootkit discovered in the wild that modified UEFI firmware. Discovered in 2018 by ESET, LoJax rewrote bootloader components in SPI flash and dropped a persistent agent that re-infects the system post-reimage. It used a combination of UEFI patching and Windows-based loader modules. Unlike MoonBounce, it also installed a kernel driver to maintain control during Windows runtime.

**Key Behaviors:**
- SPI flash infection
- Modified bootloader (bootmgfw.efi)
- Used kernel driver (`LoJack.sys`)
- Survived full OS reinstalls

**Detailed Report:**  
[https://www.welivesecurity.com/2018/09/27/lojax-first-uefi-rootkit-found-wild/](https://www.welivesecurity.com/2018/09/27/lojax-first-uefi-rootkit-found-wild/)

---

## 🟥 MosaicRegressor

**Summary:**  
MosaicRegressor is a sophisticated multi-component malware framework targeting diplomats and government officials, revealed by Kaspersky in 2020. It included UEFI firmware implants alongside traditional malware delivery vectors. It leveraged signed Microsoft binaries, used WMI event consumers, and employed scheduled task persistence. MosaicRegressor was deployed in highly targeted espionage campaigns.

**Key Behaviors:**
- Multiple persistence vectors (WMI, scheduled tasks)
- Forged Microsoft-signed binaries
- Registry and IFEO hijacking
- Optional UEFI payloads (based on target)

**Detailed Report:**  
[https://securelist.com/mosaicregressor/98717/](https://securelist.com/mosaicregressor/98717/)

---

## 🧬 Rootkit Behavior Comparison Matrix

| Behavior                        | MoonBounce (APT41) | LoJax (APT28) | MosaicRegressor | Your Variant |
|--------------------------------|---------------------|---------------|------------------|--------------|
| UEFI Persistence               | ✅                  | ✅            | ✅               | ✅           |
| Catalog Trust Spoofing         | ✅                  | ✅            | ✅               | ✅           |
| Survives Reinstalls            | ✅                  | ✅            | ✅               | ✅           |
| Forged Signed Binaries         | ✅                  | ✅            | ✅               | ✅           |
| Task Scheduler Persistence     | ❌                  | ❌            | ✅               | ✅           |
| Rundll32 Execution Chain       | ✅                  | ✅            | ✅               | ✅           |
| Admin Token Neutering          | ✅                  | ✅            | ✅               | ✅           |
| WMI Event Obfuscation          | ✅                  | ✅            | ❌               | ✅           |
| Hidden System32 Payloads       | ✅                  | ✅            | ✅               | ✅           |
| API Hooking / Trust Hijack     | ✅                  | ✅            | ✅               | ✅           |
